
library(vioplot)

all_data=read.csv("nature_fossil_dataset_April2023.csv",header=T,stringsAsFactors=F) # SI Table 1

# vioplot d15N all units
cycad_color="skyblue3"
non_cycad_color=rgb(1,0,0,0.6)
all_data_color=cbind(all_data, NA)
colnames(all_data_color)=c(colnames(all_data),"col")
i=1
color_out=NULL
for(i in 1:length(all_data_color$taxon1)){
	cur_samp=all_data_color[i,]
	if(cur_samp$taxon1=="cycad"){cur_samp$col=cycad_color}
	if(cur_samp$taxon1=="non_cycad"){cur_samp$col=non_cycad_color}
	color_out=rbind(color_out,cur_samp)
}

par(mfrow=c(1,1))
par(family="CMU")
par(mar=c(1,4,1,1))
par(oma=c(0,0,0,0))
vioplot(all_data$d15N~all_data$all_nums,las=1,ylim=c(-5,11),yaxt="n",xaxt="n",frame.plot=F,lwd=1.25,cex=1.3,staplewex=0,border=NA,pchMed=21,colMed="white",colMed2="white",col="white",lty=1,xlab=NA,ylab=NA,range=1)
rect(-5,-2.6,75,0.9,border=F,col="grey85")
vioplot(all_data$d15N~all_data$all_nums,las=1,ylim=c(-5,11),axes=F,frame.plot=F,lwd=1.25,cex=1.3,border=NA,pchMed=NA,col=c(cycad_color, "white","white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color,"white","white", cycad_color, "white","white","white", cycad_color, non_cycad_color,"white","white", cycad_color, non_cycad_color),lty=1,xlab=NA,ylab=NA,range=2,add=T,drawRect=T,rectCol="black",lineCol="black",yaxt="n",xaxt="n",wex=1.3)
stripchart(color_out $d15N~ color_out $all_nums,vertical=TRUE,method="jitter",jitter=0.15,pch=1,cex=1.1,col="black",add=TRUE,axes=F)
rect(36.5,-1,37.5,-2,border=F,col="grey85")
points(37,-1.63,pch=21,cex=1.4,bg=cycad_color)
rect(37.5,-2.75,38.5,-5,border=F,col="white")
points(38,-3,pch=21,cex=1.4,bg=non_cycad_color)
points(38,-4.2,pch=21,cex=1.4,bg=non_cycad_color)
rect(44.5,5.3,45.35,6.5,border=F,col="white")
points(45,5.73,pch=21,cex=1.4,bg=cycad_color)
rect(1.5,1.1,2.5,3,border=F,col="white")
points(2,1.4,pch=21,cex=1.4,bg=non_cycad_color)
points(2,2.3,pch=21,cex=1.4,bg=non_cycad_color)
rect(-5,7.5,75,10,border=NA,col="white")
axis(side=2,lwd=1,las=1,tck=-0.02,mgp=c(3,0.5,0),cex.axis=1.1)
mtext(side=2,line=2,expression(delta^{15}*"N (\u2030)"),cex=1.1)
text(3,-1.5,"modern cycad foliage",col='grey20',cex=1.1)
box(lwd=1)




# d15N vs. C/N all units [Extended Data Figure 1]

par(family="CMU")
par(xpd=F)
par(mfrow=c(3,4))
par(mar=c(3.5,3.5,1,1))
par(oma=c(0,0,0,0))
plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(soma_cycad_data$d15N~soma_cycad_data$CN,col="darkblue",pch=1)
points(soma_non_cycad_data$d15N~soma_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(A)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(jiri_cycad_data$d15N~jiri_cycad_data$CN,col="darkblue",pch=1)
points(jiri_non_cycad_data$d15N~jiri_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(B)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(panama_cycad_data$d15N~panama_cycad_data$CN,col="darkblue",pch=1)
points(panama_non_cycad_data$d15N~panama_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(C)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,col="darkblue",pch=1)
points(chuckanut_non_cycad_data$d15N~chuckanut_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(D)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(tasmania_cycad_data$d15N~tasmania_cycad_data$CN,col="darkblue",pch=1)
points(tasmania_non_cycad_data$d15N~tasmania_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(E)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(castlerock_cycad_data$d15N~castlerock_cycad_data$CN,col="darkblue",pch=1)
points(castlerock_non_cycad_data$d15N~castlerock_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(F)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(nanaimo_cycad_data$d15N~nanaimo_cycad_data$CN,col="darkblue",pch=1)
points(nanaimo_non_cycad_data$d15N~nanaimo_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(G)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(yorkshire_cycad_data$d15N~yorkshire_cycad_data$CN,col="darkblue",pch=1)
points(yorkshire_non_cycad_data$d15N~yorkshire_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(H)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(kap_cycad_data$d15N~kap_cycad_data$CN,col="darkblue",pch=1)
points(kap_non_cycad_data$d15N~kap_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(I)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(lunz_cycad_data$d15N~lunz_cycad_data$CN,col="darkblue",pch=1)
points(lunz_non_cycad_data$d15N~lunz_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(J)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(thale_cycad_data$d15N~thale_cycad_data$CN,col="darkblue",pch=1)
points(thale_non_cycad_data$d15N~thale_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(K)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$CN,ylim=c(-5,10),xlim=c(1,100),cex=0,axes=F,xlab="",ylab="")
rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(antarctica_cycad_data$d15N~antarctica_cycad_data$CN,col="darkblue",pch=1)
points(antarctica_non_cycad_data$d15N~antarctica_non_cycad_data$CN,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1)
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext("C/N (mol/mol)",side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(7.5,9.25,"(L)",cex=1.2)


# d15N vs. D(TN) all units [Extended Data Figure 2]

par(family="CMU")
par(mfrow=c(3,4))
par(mar=c(3.5,3.5,1,1))
par(oma=c(0,0,0,0))
plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(soma_cycad_data$d15N~soma_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(soma_non_cycad_data$d15N~soma_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(A)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(jiri_cycad_data$d15N~jiri_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(jiri_non_cycad_data$d15N~jiri_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(B)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(panama_cycad_data$d15N~panama_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(panama_non_cycad_data$d15N~panama_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(C)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(chuckanut_non_cycad_data$d15N~chuckanut_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(D)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(tasmania_cycad_data$d15N~tasmania_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(tasmania_non_cycad_data$d15N~tasmania_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(E)",cex=1.2)


plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(castlerock_cycad_data$d15N~castlerock_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(castlerock_non_cycad_data$d15N~castlerock_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(F)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
#rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(nanaimo_cycad_data$d15N~nanaimo_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(nanaimo_non_cycad_data$d15N~nanaimo_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(G)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
#rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(yorkshire_cycad_data$d15N~yorkshire_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(yorkshire_non_cycad_data$d15N~yorkshire_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(H)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
#rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(kap_cycad_data$d15N~kap_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(kap_non_cycad_data$d15N~kap_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(I)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
#rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(lunz_cycad_data$d15N~lunz_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(lunz_non_cycad_data$d15N~lunz_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(J)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
#rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(thale_cycad_data$d15N~thale_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(thale_non_cycad_data$d15N~thale_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(K)",cex=1.2)

plot(chuckanut_cycad_data$d15N~chuckanut_cycad_data$TN_fossil_matrix,ylim=c(-5,10),xlim=c(0.75,100),cex=0,axes=F,xlab="",ylab="",log="x")
#rect(18,50,65,-50,border=F,col="grey80")
#rect(-20,0.9,500,-2.6,border=F,col="grey80")
abline(h=0.9,lty=2)
abline(h=-2.6,lty=2)
points(antarctica_cycad_data$d15N~antarctica_cycad_data$TN_fossil_matrix,col="darkblue",pch=1)
points(antarctica_non_cycad_data$d15N~antarctica_non_cycad_data$TN_fossil_matrix,col="red",pch=3)
axis(side=1,tck=-0.02,mgp=c(3,0.5,0),las=1,at=c(1,10,100))
axis(side=2,tck=-0.02,mgp=c(3,0.5,0),las=1)
box(lwd=1)
mtext(expression("TN"[fossil]*"/TN"[matrix]),side=1,line=1.75,cex=0.8)
mtext(expression(delta^{15}*"N (\u2030)"),side=2,line=1.5,cex=0.8)
text(1,9.25,"(L)",cex=1.2)



# TN fossil matrix histogram

par(mfrow=c(1,1))
hist(log(all_data$TN_fossil_matrix,10),axes=F,xlab=NA,ylab=NA,main="",col="grey80",border="black")
axis(side=1,mgp=c(3,0.5,0),tck=-0.02,at=c(0,1,2),labels=c(1,10,100))
axis(side=2,mgp=c(3,0.5,0),tck=-0.02,las=1)
mtext(side=2,line=2,"# of analyses")
mtext(side=1,line=2,expression("N"["fossil"]*"/N"["matrix"]))


